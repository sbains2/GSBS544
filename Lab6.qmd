---
title: GSBS544 Lab 6
author: Sahil Bains
format:
  html:
    embed-resources: true
    code-fold: true
echo: true
---
Github Link: https://github.com/sbains2/GSBS544

```{python}
import pandas as pd
import numpy as np
from sklearn.pipeline import Pipeline
from sklearn.compose import make_column_selector, ColumnTransformer
from sklearn.preprocessing import StandardScaler, OneHotEncoder, PolynomialFeatures
from sklearn.linear_model import LinearRegression, Ridge, Lasso, ElasticNet 
from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.metrics import r2_score
import math

# Importing the data and doing some checks
df = pd.read_csv('hitters.csv')
df.info()
df.describe()

```


```{python}
# Removing NA's in the salary - dropped about 60 rows
df = df.dropna(subset=['Salary'])
df
```

Part I: Different Model Specs
A. Regression without regularization
Create a pipeline that includes all the columns as predictors for Salary, and performs ordinary linear regression

```{python}

# Defining X and y
X = df.drop(columns=['Salary'])
y = df['Salary']

# Defining numeric columns
numeric = X.select_dtypes(include=[np.number]).columns

# Setting up column transformer
ct = ColumnTransformer(
    [ # Dummifying league, division, and new league
        ('dummify', OneHotEncoder(sparse_output=False), ['League', 'Division', 'NewLeague']),
        # Standardizing all numeric variables
        ('standardize', StandardScaler(), numeric)
    ],
    remainder='drop'
)

# Setting up pipeline
pipe = Pipeline(
  [("preprocessing", ct),
  ("linear_regression", LinearRegression())]
)

# Splitting training and testing variables
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

pipe.fit(X_train, y_train)

r2 = pipe.score(X_test, y_test)
print(r2)

```

Fit this pipeline to the full dataset, and interpret a few of the most important coefficients.

```{python}

```

Use cross-validation to estimate the MSE you would expect if you used this pipeline to predict 1989 salaries.


```{python}

```